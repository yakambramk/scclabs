<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Show Hibernate/JPA SQL Statements in Spring Boot</title>
</head>
<style>
    .content {
        flex-grow: 0.5;
        padding: 20px;

    }

    .container {
        max-width: 800px;
        margin: auto;
    }

    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        display: flex;
    }

    h1 {
        margin-bottom: 20px;
        text-align: left;
        color: red;
    }

    h4 {
        color: red;
    }

    .circle-list {
        list-style-type: circle;
        /* Use circles for list items */
    }

    pre {
        background-color: #edf3f2;
        color: #282c34;
        padding: 20px;
        border-color: #282c34;
        border-radius: 5px;
        overflow-x: auto;
        font-family: 'Courier New', Courier, monospace;
        font-size: 15px;


    }

    code {
        white-space: pre-wrap;
        word-wrap: break-word;

    }

    a {
        text-decoration: none;
    }

    .directory {
        color: red;
    }

    .java-file {
        color: blue;
    }
</style>

<body>
    <div class="content">
        <div class="overlap-container">
            <div class="container">
                <h1>Show Hibernate/JPA SQL Statements in Spring Boot</h1>
                <h4>author : Sai K</h4>
                <P>Seeing the SQL statements generated by Hibernate/JPA can be very helpful for debugging and
                    performance <br><br>tuning. Spring Boot makes it easy to enable SQL logging. In this guide, we'll cover how
                    to configure your Spring <br><br>Boot application to show SQL statements and the associated parameter
                    values.</P><br>
                <h2>Prerequisites</h2>
                <ul>
                    <li>JDK 17 or later</li><br>
                    <li>Maven</li><br>
                    <li>IDE (IntelliJ IDEA, Eclipse, etc.)</li><br>

                </ul>
                <h2>Step-by-Step Guide</h2>
                <h3>Step 1: Set Up a Spring Boot Project</h3>
                <p>Use<a href="https://start.spring.io/"> Spring Initializr</a> to generate a new Spring Boot project
                    with the following configuration:</p>
                <ul>
                    <li>Project: Maven Project</li><br>
                    <li>Language: Java</li><br>
                    <li> Spring Boot: 3.2.x</li><br>
                    <li>Dependencies: Spring Web, Spring Data JPA, H2 Database (or any other database of your
                        choice)Spring<br><br> Web</li><br>
                </ul>
                <p>Download and unzip the project, then open it in your IDE.</p>
                <h3>Step 2: Configure the Database</h3>
                <h2>2.1 Configure application.properties </h2>
                <p>Set up your database configuration in the src/main/resources/application.properties file. For this
                    guide, we'll use <br><br> an in-memory H2 database and configure the necessary properties to show SQL
                    statements.</p><br>
                <pre>
    <code>
# src/main/resources/application.properties

# H2 Database configuration
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.datasource.platform=h2

# Hibernate configuration
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.highlight_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true

# Logging configuration
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
    </code>
</pre>
                <h3>Explanation:</h3>
                <ul>
                    <li>spring.jpa.show-sql=true: Enables the logging of SQL statements.</li><br>
                    <li> spring.jpa.properties.hibernate.format_sql=true: Formats the SQL statements to make them more
                        readable.</li><br>
                    <li> spring.jpa.properties.hibernate.highlight_sql=true: Highlights the SQL statements in the logs.
                    </li><br>
                    <li> spring.jpa.properties.hibernate.use_sql_comments=true: Adds comments to SQL statements for
                        better readability.</li><br>
                    <li>logging.level.org.hibernate.SQL=DEBUG: Sets the logging level for Hibernate SQL statements to
                        DEBUG.</li><br>
                    <li> logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE: Logs the binding of
                        parameters to SQL statements.</li><br>
                </ul>
                <h3>Step 3: Define Your Entity</h3>
                <p>Create a simple Student entity in the com.example.demo.entity package.</p>
                <pre><code>
    package com.example.demo.entity;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;

@Entity
public class Student {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;
    private String email;

    // Getters and setters
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }
}
</code></pre>
                <h2>Step 4: Create a Repository</h2>
                <p>Create an interface named StudentRepository in the com.example.demo.repository package.</p>
                <pre><code>
package com.example.demo.repository;

import com.example.demo.entity.Student;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface StudentRepository extends JpaRepository<Student, Long> {
}
</code></pre>
                <h3>Step 5: Create a Service</h3>
                <p>Create a service class named StudentService in the com.example.demo.service package.</p>
                <pre><code>
package com.example.demo.service;

import com.example.demo.entity.Student;
import com.example.demo.repository.StudentRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class StudentService {

    @Autowired
    private StudentRepository studentRepository;

    public List<Student> getAllStudents() {
        return studentRepository.findAll();
    }

    public Student saveStudent(Student student) {
        return studentRepository.save(student);
    }
}
</code></pre>
                <h3>Step 6: Create a Controller</h3>
                <p>Create a controller class named StudentController in the com.example.demo.controller package.</p>
                <pre><code>
    package com.example.demo.controller;

import com.example.demo.entity.Student;
import com.example.demo.service.StudentService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
public class StudentController {

    @Autowired
    private StudentService studentService;

    @GetMapping("/students")
    public List<Student> getAllStudents() {
        return studentService.getAllStudents();
    }

    @PostMapping("/students")
    public Student saveStudent(@RequestBody Student student) {
        return studentService.saveStudent(student);
    }
}
</code></pre>
                <h2>Step 7: Running and Testing the Application</h2>
                <h3>7.1 Run the Application</h3>
                <p>Run the Spring Boot application using your IDE or the command line:</p><br>
                <pre><code>./mvnw spring-boot:run</code></pre>
                <h3>7.2 Test the SQL Logging</h3>
                <p>Use a tool like Postman or your web browser to test the endpoints:</p><br>
                <p>1.<b>Create a new student:</b></p>
                <ul>
                    <li>URL: http://localhost:8080/students </li><br>
                    <li> Method: POST</li><br>
                    <li>Body:</li><br>
                </ul>
                <pre><code>
                    {
                    "name": "John Doe",
                    "email": "john.doe@example.com"
                  }</code></pre>
                <p>2. <b>Retrieve all students:</b></p>
                <ul>
                    <li>URL: http://localhost:8080/students</li><br>
                    <li>Method: GET</li><br>
                </ul>
                <p>
                    Check the console output to see the SQL statements and parameter values being logged. You should see<br><br>
                    formatted SQL statements, highlighted if supported by your console, and detailed logs showing
                    parameter<br><br> binding.
                </p><br>
                <h2>Conclusion</h2>
                <p>In this guide, you have learned how to enable and configure SQL statement logging in a Spring Boot
                    application <br><br>using Hibernate/JPA. We covered:</p><br>
                <ul>
                    <li>Setting up a Spring Boot project with the necessary dependencies.</li><br>
                    <li>Configuring the application.properties file to enable SQL logging.</li><br>
                    <li> Creating a simple entity, repository, service, and controller.</li><br>
                    <li>Running and testing the application to see the SQL statements in the logs.</li><br>
                </ul>
                <p>By following these steps, you can easily debug and monitor the SQL statements generated by
                    Hibernate/JPA in <br><br>your Spring Boot applications.</p><br>
                <h2>Related Spring and Spring Boot Tutorials/Guides:</h2>
            </div>
        </div>
    </div>
</body>

</html>