<!DOCTYPE html>
<html lang="en">

<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <meta name="author" content="Fullstack Institute" />
    <meta name="author" content="Yakambram Kommu" />

    <style>
        .container-fluid {
            width: 70%;
            background-color: rgb(106, 51, 194);
            /* Updated color */
            padding: 0;
            margin: 0;
        }

        .topImage {
            display: flex;
            justify-content: center;
            /* Centers the image horizontally */
            align-items: center;
            /* Centers the image vertically */
        }

        .topImage img {
            max-width: 80%;
            /* Ensures the image is responsive */
            height: auto;
            /* Maintains the aspect ratio */
            border-radius: 8px;
            /* Optional: adds rounded corners to the image */
        }

        .heading {
            color: rgb(204, 145, 9);
        }

        span {
            background-color: rgb(224, 237, 235);
            color: #d73a49;
        }

        pre {
            background-color: #282c34;
            color: #edf3f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            font-size: 18px;
        }

        code {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        p {
            display: block;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            unicode-bidi: isolate;
        }

        .btn {
            transition: transform 0.3s ease;
        }

        .btn:hover {
            transform: scale(1.1);
            /* Zoom in */
        }

        .btn:active {
            transform: scale(0.9);
            /* Zoom out on click */
        }
    </style>

</head>

<body>
    <div class="container">
        <div class="topImage mt-2 mb-4">
            <img src="../../assets/springboot images/Spring Boot DTO Validation.jpg" alt="logo" />
        </div>
    </div>

    <div class="container">
        <div class="heading">
            <h3>Spring Boot DTO Validation Example</h3>
            <h6>Author: SAI K</h6>
        </div><br>
        <p>In this tutorial, we will learn how to validate Spring boot REST API DTO requests using Hibernate validator.
        </p>
        <b>Check out my bestseller Udemy courses:</b>
        <ol>
            <li><a href="">Building Real-Time REST APIs with Spring Boot and Deploy on AWS Cloud</a></li>
            <li><a href="">Testing Spring Boot Application with JUnit and Mockito (Includes Testcontainers)</a></li>
            <li><a href="">Master Spring Data JPA with Hibernate</a></li>
        </ol>
        <p>In Java, the Java Bean Validation framework has become the de-facto standard for handling validations in Java
            projects. <br><br>

            JSR 380 is a specification of the Java API for bean validation and this ensures that the properties of a
            bean meet specific criteria, using annotations such as @NotNull, @Min, and @Max.</p>
        <p><b>Hibernate Validator is the reference implementation of the validation API.</b> <br><br>

            We create and use DTOs (Data Transfer Objects) to transform data between client and server. <br><br>

            Data Transfer Object Design Pattern is a frequently used design pattern. It is basically used to pass data
            with multiple attributes in one shot from client to server, to avoid multiple calls to a remote server.
            <br><br>

            Instead of adding Java Bean Validation annotations to JPA entities, we will add Java Bean Validation
            annotations to DTO because we will use DTO in the request and response of the REST API.</p>


        <h3>Important Java bean validations</h3>
        <ul>
            <li><b>@NotNull</b> validates that the annotated property value is not null.</li>
            <li><b>@Size</b> validates that the annotated property value has a size between the attributes min and max;
                can be applied to String, Collection, Map, and array properties.</li>
            <li><b>@Min</b> validates that the annotated property has a value not smaller than the value attribute.</li>
            <li><b>@Max</b> validates that the annotated property has a value no larger than the value attribute.</li>
            <li><b>@Email</b> validates that the annotated property is a valid email address.</li>
            <li><b>@NotEmpty</b> validates that the property is not null or empty; can be applied to String, Collection,
                Map, or Array values.</li>
            <li><b>@NotBlank</b> can be applied only to text values and validates that the property is not null or
                whitespace.</li>
        </ul>
        <div style="border-left: 8px solid rgb(237, 21, 21); height: 100px;"><br>
            <p>Check out the complete list here at<a
                    href="https://www.sourcecodeexamples.net/2021/03/java-bean-validation-annotation-list.html">
                    https://www.sourcecodeexamples.net/2021/03/java-bean-validation-annotation-list.html</a>
            </p>
        </div><br>
        <h3>Validation in Spring Boot</h3>
        <p>Spring boot provides good integration support with Hibernate validator. <br><br>

            We will use Hibernate Validator, which is one of the reference implementations of the bean validation API.
            <br><br>

            Starting with Boot 2.3, we need to explicitly add the spring-boot-starter-validation dependency:</p>

        <code><pre>
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;
&lt;/dependency&gt;</pre></code><br>

        <h3>Spring Boot DTO Validation Example</h3>
        <p>Let's create a step-by-step example to demonstrate how to validate the Spring boot REST API DTO request using
            Hibernate validator.</p>

        <h3>1. Create a Spring boot application in STS</h3>
        <p>Use the below guide to create a Spring boot project in Eclipse STS IDE: </p>
        <div style="border-left: 8px solid rgb(237, 21, 21); height: 100px;"><br>
            <p>=><a href="http://127.0.0.1:5500/spring_boot_tutorial.html">Create Spring Boot Project in Spring Tool Suite [STS]</a></p>
        </div><br>


        <p>- Give project name as <b>springboot-validation</b>. <br> <br>
            - Add the below dependencies to this project:</p>
        <ul>
            <li>Spring Web</li>
            <li>Validation</li>
            <li>Spring Data JPA</li>
            <li>H2 database</li>
        </ul>
        <h3>2. Maven Dependencies</h3>
        <p>After creating the spring boot project, verify your <span>pom.xml</span> with the below <span>pom.xml</span>
            file:</p>
        <code><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
	&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
	&lt;parent&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
		&lt;version&gt;3.0.4&lt;/version&gt;
		&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
	&lt;/parent&gt;
	&lt;groupId&gt;net.javaguides&lt;/groupId&gt;
	&lt;artifactId&gt;springboot-validation&lt;/artifactId&gt;
	&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
	&lt;name&gt;springboot-validation&lt;/name&gt;
	&lt;description&gt;Demo project for Spring Boot and Hibernate Validator&lt;/description&gt;
	&lt;properties&gt;
		&lt;java.version&gt;17&lt;/java.version&gt;
	&lt;/properties&gt;
	&lt;dependencies&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
		&lt;/dependency&gt;

		&lt;dependency&gt;
			&lt;groupId&gt;com.h2database&lt;/groupId&gt;
			&lt;artifactId&gt;h2&lt;/artifactId&gt;
			&lt;scope&gt;runtime&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
	&lt;/dependencies&gt;

	&lt;build&gt;
		&lt;plugins&gt;
			&lt;plugin&gt;
				&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
				&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
			&lt;/plugin&gt;
		&lt;/plugins&gt;
	&lt;/build&gt;

&lt;/project&gt;</pre></code><br>
        <h3>3. Create User Class</h3>
        <p>Let's create a new model package. Inside this model package, create a <span>User</span> JPA class and add the
            following content to it:</p>
        <code><pre>
package net.javaguides.springboot.model;

import jakarta.persistence.*;

@Table(name = "users")
@Entity
public class User {
	
	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private long id;
	
	@Column(name = "name", nullable = false)
	private String name;
	
	private String email;
	
	private String password;
	
	public User() {
		
	}
	
	public User(String name, String email, String password) {
		super();
		this.name = name;
		this.email = email;
		this.password = password;
	}
	public long getId() {
		return id;
	}
	public void setId(long id) {
		this.id = id;
	}
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
	public String getEmail() {
		return email;
	}
	public void setEmail(String email) {
		this.email = email;
	}
	public String getPassword() {
		return password;
	}
	public void setPassword(String password) {
		this.password = password;
	}
}</pre></code><br>
        <h3>4. Create UserDto Class</h3>
        <p>Let's create a dto package. Inside dto package, create UserDto class and add the following content to it:</p>
        <code><pre>
package net.javaguides.springboot.dto;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotEmpty;
import jakarta.validation.constraints.Size;

public class UserDto {
	
	private long id;
	
	// user name should not be null or empty
	// user name should have at least 2 characters
	@NotEmpty
	@Size(min = 2, message = "user name should have at least 2 characters")
	private String name;
	
	// email should be a valid email format
	// email should not be null or empty
	@NotEmpty
	@Email
	private String email;
	
	// password should not be null or empty
	// password should have at least 8 characters
	@NotEmpty
	@Size(min = 8, message = "password should have at least 8 characters")
	private String password;
	
	public UserDto() {
		
	}
	
	public UserDto(String name, String email, String password) {
		super();
		this.name = name;
		this.email = email;
		this.password = password;
	}
	public long getId() {
		return id;
	}
	public void setId(long id) {
		this.id = id;
	}
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
	public String getEmail() {
		return email;
	}
	public void setEmail(String email) {
		this.email = email;
	}
	public String getPassword() {
		return password;
	}
	public void setPassword(String password) {
		this.password = password;
	}
}</pre></code><br>
        <p>Note that we have added below Java bean validation annotations to <span>UserDto</span> class:</p>
        <ul>
            <li><b>@NotEmpty</b> validates that the property is not null or empty; can be applied to String, Collection,
                Map, or Array values.</li>
            <li><b>@Size</b> validates that the annotated property value has a size between the attributes min and max;
                can be applied to String, Collection, Map, and array properties.</li>
            <li><b>@Email</b> validates that the annotated property is a valid email address.</li>
        </ul>

        <h3>5. Configure Database</h3>
        <p> Spring boot automatically configures database details for H2 in-memory database so we no need to explicitly
            add the database configuration in the application.properties file.</p>
        <h3>6. Create UserRepository</h3>
        <p>Let's create a repository package. Inside this package, create a UserRepository class that talks with the
            database. Add the following content to it:</p>
        <code><pre>
package net.javaguides.springboot.repository;

import org.springframework.data.jpa.repository.JpaRepository;

import net.javaguides.springboot.model.User;

public interface UserRepository extends JpaRepository<User, Long>{

}</pre></code><br>
        <h3>7. Create UserService Class</h3>
        <p>Let's create a service package. Inside this package, create a UserService class and add the following code to
            it:</p>
        <code><pre>
package net.javaguides.springboot.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import net.javaguides.springboot.model.User;
import net.javaguides.springboot.repository.UserRepository;

@Service
public class UserService {
	
	@Autowired
	private UserRepository userRepository;
	
	public User createUser(User user) {
		return userRepository.save(user);
	}	
}</pre></code><br>
        <h3>8. Create UserController Class</h3>
        <p>Let's create a controller package. Inside this package, create a UserController class and add the following
            content to it:</p>
        <code><pre>
package net.javaguides.springboot.controller;

import jakarta.validation.Valid;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import net.javaguides.springboot.model.User;
import net.javaguides.springboot.dto.UserDto;
import net.javaguides.springboot.service.UserService;

@RestController
@RequestMapping("/api/")
public class UserController {
	
	@Autowired
	private UserService userService;
	
	@PostMapping("users")
	public ResponseEntity< UserDto> createUser(@Valid @RequestBody UserDto userDto){
	
		// convert UserDto to User entity
		User user = new User();
		user.setName(userDto.getName());
		user.setEmail(userDto.getEmail());
		user.setPassword(userDto.getPassword());
		User savedUser = userService.createUser(user);
		
		// convert User entity to UserDto class
		UserDto userResponse = new UserDto();
		userResponse.setId(savedUser.getId());
		userResponse.setName(savedUser.getName());
		userResponse.setEmail(savedUser.getEmail());
		// don't provide password to client
		// userResponse.setPassword(savedUser.getPassword());
		
		return new ResponseEntity< User>(userResponse, HttpStatus.CREATED);
	}
}</pre></code><br>
        <p>Note that we enable validation on Spring Rest Controller by adding <b>@Valid </b>annotation in addition to
            <b>@RequestBody</b> in the <span>createUser()</span> method.</p>
        <h3>9. Create ValidationHandler</h3>
        <p>Let's create a ValidationHandler to customize the validation response. <br><br>

            To customize response validation, we need to extend <span>ResponseEntityExceptionHandler</span> class and
            override <span>handleMethodArgumentNotValid(MethodArgumentNotValidException ex</span>, <span>HttpHeaders
                headers, HttpStatus status, WebRequest request</span> ) method. <br><br>

            Let's create <b>ValidationHandler</b> class and add the following content to it:</p>

        <code><pre>
package net.javaguides.springboot.controller;

import java.util.HashMap;
import java.util.Map;

import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.validation.FieldError;
import org.springframework.web.bind.MethodArgumentNotValidException;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.context.request.WebRequest;
import org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler;

@ControllerAdvice
public class ValidationHandler extends ResponseEntityExceptionHandler{
	
	@Override
	protected ResponseEntity< Object> handleMethodArgumentNotValid(MethodArgumentNotValidException ex,
			HttpHeaders headers, HttpStatus status, WebRequest request) {
		
		Map< String, String> errors = new HashMap< >();
		ex.getBindingResult().getAllErrors().forEach((error) ->{
			
			String fieldName = ((FieldError) error).getField();
			String message = error.getDefaultMessage();
			errors.put(fieldName, message);
		});
		return new ResponseEntity< Object>(errors, HttpStatus.BAD_REQUEST);
	}
}</pre></code><br>

        <h3>10. Run Spring Boot App</h3>
        <p>Run the Spring boot application with the main class:</p>
        <code><pre>
package net.javaguides.springboot;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class SpringbootValidationApplication {

	public static void main(String[] args) {
		SpringApplication.run(SpringbootValidationApplication.class, args);
	}

}</pre></code><br>
        <h3>11. Testing using Postman Client</h3>
        <p>The below screenshot shows the validation of Spring boot REST API using Hibernate validator:</p>
        <div class="topImage mt-2 mb-4">
            <img src="../../assets/springboot images/Testing using Postman Client.png" alt="logo" />
        </div><br>

        <h3>11. Conclusion</h3>
        <p>In this tutorial, we learned how to validate DTO objects in Spring boot REST API using Hibernate validator. </p>
        <div style="border-left: 8px solid rgb(237, 21, 21); height: 100px;"><br>
            <p>The source code of this tutorial available on my GitHub repository at<a href="https://github.com/RameshMF/springboot-validation">https://github.com/Sai/springboot-validation</a></p>
        </div><br>

        <p>Starting with Boot 2.3, we need to explicitly add the <span>spring-boot-starter-validation</span> dependency:</p>
        <code><pre>
&lt;dependency&gt; 
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; 
    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt; 
&lt;/dependency&gt;</pre></code><br><br>
                
<h3>Related Spring and Spring Boot Tutorials/Guides:</h3>

            <p>
                <button type="button" class="btn btn-outline-primary">Spring Boot Tutorials [500+]s</button>
                <button type="button" class="btn btn-outline-secondary">Spring Boot Testing Tutorial</button>
                <button type="button" class="btn btn-outline-success">Spring Boot Microservice Tutorial</button>
                <button type="button" class="btn btn-outline-danger">Spring Boot Kafka Microservices </button>
                <button type="button" class="btn btn-outline-warning">Spring Boot + Apache Kafka Tutorial</button>
                <button type="button" class="btn btn-outline-info">Spring Core Tutorial</button>
                <button type="button" class="btn btn-outline-primary">Spring MVC Tutorial </button>
                <button type="button" class="btn btn-outline-secondary">Spring Data JPA Tutorial</button>
                <button type="button" class="btn btn-outline-success">Spring Framework for Beginners</button>
                <button type="button" class="btn btn-outline-danger">Spring AOP Tutorial</button>
                <button type="button" class="btn btn-outline-warning">Spring Security Tutorial</button>
                <button type="button" class="btn btn-outline-info">Spring Exceptions Tutorial</button>
                <button type="button" class="btn btn-outline-primary">Spring Boot Interview Questions</button>
                <button type="button" class="btn btn-outline-dark">Spring Boot Microservices Interview Questions</button>
                <button type="button" class="btn btn-outline-primary">Apache Kafka Tutorials </button>
                <button type="button" class="btn btn-outline-secondary">Docker Tutorials and Guides</button>
                <button type="button" class="btn btn-outline-success">Spring Boot RabbitMQ Tutorials</button>
                <button type="button" class="btn btn-outline-danger">Angular CRUD Example with Spring Boot </button>
                <button type="button" class="btn btn-outline-warning">Spring Boot + Angular 12 CRUD Full Stack</button>
                <button type="button" class="btn btn-outline-info">Spring Boot + Angular 8 CRUD Full Stack</button>
                <button type="button" class="btn btn-outline-danger">Spring Boot + Angular 10 CRUD Full Stack </button>
                <button type="button" class="btn btn-outline-primary">React JS ( React Hooks) + Spring Boot</button>
                <button type="button" class="btn btn-outline-secondary">Spring Boot + React JS CRUD Full Stack</button>
                <button type="button" class="btn btn-outline-success">Spring Boot Thymeleaf CRUD Full Stack </button>
                <button type="button" class="btn btn-outline-danger">Spring Boot User Registration and Login</button>
                <button type="button" class="btn btn-outline-warning">Node Js + Express + MongoDB CRUDVue</button>
                <button type="button" class="btn btn-outline-info">JS + Spring Boot REST API Tutorial</button>
            </p>

    </div>
</body>

</html>